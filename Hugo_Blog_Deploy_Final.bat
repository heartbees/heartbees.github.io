@echo off
:: 1. é…ç½®CMDä¸ºGBKç¼–ç ï¼ˆè§£å†³ä¸­æ–‡ä¹±ç ï¼‰ï¼Œä¸æ˜¾ç¤ºæ‰§è¡Œç»“æžœ
chcp 936 > nul
title Hugo åšå®¢ç»ˆæžéƒ¨ç½²è„šæœ¬ï¼ˆæ°¸ä¸æ¶ˆå¤±+æ— åˆ†æ”¯åˆ‡æ¢ï¼‰

:: 2. å®šä¹‰åšå®¢æ ¹ç›®å½•ï¼ˆä¸Žè„šæœ¬æ‰€åœ¨ç›®å½•ä¸€è‡´ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®ï¼‰
set BLOG_ROOT=D:\HuaweiMoveData\Users\86198\Desktop\my-blog
cd /d %BLOG_ROOT%

echo ========================================
echo å¼€å§‹æ‰§è¡ŒHugoåšå®¢éƒ¨ç½²æµç¨‹...
echo ========================================

:: ã€1/4ã€‘æäº¤æœ¬åœ°æºç ä¿®æ”¹ï¼ˆæœ¬åœ°ä¼˜å…ˆï¼‰
echo ã€1/4ã€‘æäº¤æœ¬åœ°æºç ä¿®æ”¹ï¼šæ–°å¢ž/åˆ é™¤æ–‡ç« ï¼ˆæœ¬åœ°ä¼˜å…ˆï¼‰
git add .
git commit -m "åšå®¢æºç æ›´æ–°ï¼šæ–°å¢ž/åˆ é™¤æ–‡ç« ï¼ˆæœ¬åœ°ä¼˜å…ˆï¼‰"
if %errorlevel% equ 0 (
    echo æç¤ºï¼šæœ¬åœ°ä¿®æ”¹å·²æäº¤
) else (
    echo æç¤ºï¼šæœ¬åœ°æ— ä¿®æ”¹ï¼Œè·³è¿‡æäº¤
)

:: ã€2/4ã€‘æŽ¨é€mainåˆ†æ”¯åˆ°GitHubï¼ˆæœ¬åœ°ä¿®æ”¹è¦†ç›–è¿œç¨‹ï¼‰
echo ã€2/4ã€‘æŽ¨é€mainåˆ†æ”¯åˆ°GitHubï¼ˆæœ¬åœ°ä¿®æ”¹è¦†ç›–è¿œç¨‹ï¼‰
git push origin main -f
if %errorlevel% equ 0 (
    echo æç¤ºï¼šâœ… mainåˆ†æ”¯æŽ¨é€æˆåŠŸï¼GitHubçš„content/postså·²åŒæ­¥
) else (
    echo æç¤ºï¼šâš ï¸ mainåˆ†æ”¯æŽ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ/ä»“åº“é…ç½®
    pause
    exit /b 1
)

:: ã€3/4ã€‘æž„å»ºå…¨æ–°é™æ€æ–‡ä»¶ï¼ˆä»…æ¸…ç†publicç¼“å­˜ï¼‰
echo ã€3/4ã€‘æž„å»ºå…¨æ–°é™æ€æ–‡ä»¶ï¼ˆä»…æ¸…ç†publicç¼“å­˜ï¼‰
if exist public (
    rmdir /s /q public
    echo æç¤ºï¼šå·²åˆ é™¤æ—§publicç¼“å­˜
)
hugo
if %errorlevel% equ 0 (
    echo æç¤ºï¼šâœ… Hugoæž„å»ºæˆåŠŸï¼Œç”Ÿæˆæ–°é™æ€æ–‡ä»¶
) else (
    echo æç¤ºï¼šâŒ Hugoæž„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥HugoçŽ¯å¢ƒé…ç½®
    pause
    exit /b 1
)

:: ã€4/4ã€‘æŽ¨é€é™æ€æ–‡ä»¶åˆ°gh-pagesåˆ†æ”¯ï¼ˆæ ¸å¿ƒï¼šä¸åˆ‡æ¢åˆ†æ”¯ï¼Œå¼ºåˆ¶è¦†ç›–ï¼‰
echo ã€4/4ã€‘æŽ¨é€é™æ€æ–‡ä»¶åˆ°gh-pagesåˆ†æ”¯ï¼ˆä¸åˆ‡æ¢åˆ†æ”¯ï¼Œè„šæœ¬æ°¸ä¹…å¯è§ï¼‰
:: æ›¿æ¢æ‰€æœ‰é”™è¯¯çš„git pushï¼Œä½¿ç”¨æ­£ç¡®çš„git subtree push + -få¼ºåˆ¶è¦†ç›–
git subtree push --prefix=public origin gh-pages -f
if %errorlevel% equ 0 (
    echo æç¤ºï¼šâœ… gh-pagesåˆ†æ”¯æŽ¨é€æˆåŠŸï¼é™æ€æ–‡ä»¶å·²åŒæ­¥åˆ°çº¿ä¸Š
) else (
    echo æç¤ºï¼šâš ï¸ gh-pagesæŽ¨é€é‡è¯•ï¼ˆè§£å†³non-fast-forwardå†²çªï¼‰
    git subtree push --prefix=public origin gh-pages -f
    if %errorlevel% equ 0 (
        echo æç¤ºï¼šâœ… gh-pageså¼ºåˆ¶æŽ¨é€å®Œæˆï¼Œçº¿ä¸Šæ—§å†…å®¹å·²è¢«è¦†ç›–
    ) else (
        echo æç¤ºï¼šâŒ gh-pagesæŽ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä»“åº“åˆ†æ”¯é…ç½®
        pause
        exit /b 1
    )
)

echo ========================================
echo éƒ¨ç½²æµç¨‹æ‰§è¡Œå®Œæ¯•ï¼æ ¸å¿ƒä¿éšœï¼š
echo 1. æœ¬åœ°æ–°å¢ž/åˆ é™¤çš„æ–‡ç«  â†’ å·²è¦†ç›–åŒæ­¥åˆ°GitHub mainåˆ†æ”¯
echo 2. è¿œç¨‹æ—§æ–‡ç«  â†’ å·²è¢«æœ¬åœ°ä¿®æ”¹è¦†ç›–ï¼Œä¸ä¼šå†å›žä¼ 
echo 3. è„šæœ¬æ–‡ä»¶ â†’ æ°¸ä¹…å­˜åœ¨äºŽï¼š%BLOG_ROOT%\Hugo_Blog_Deploy_Final.bat
echo ========================================

echo ðŸ”” é‡è¦æç¤ºï¼šè„šæœ¬æœªè¢«åˆ é™¤ï¼Œä»åœ¨ %BLOG_ROOT%\Hugo_Blog_Deploy_Final.bat
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£ï¼ˆå¯åŽ»åšå®¢æ ¹ç›®å½•æŸ¥çœ‹è„šæœ¬ï¼Œæ°¸ä¹…å¯è§ï¼‰
pause > nul
exit /b 0